{% include 'navbar.html' %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Atalanta BC Store</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>

<div class="container my-4">

  <h2 class="text-center mb-4">🛍️ Atalanta BC Official Store</h2>

  <!-- Search & Cart Summary -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4 gap-3">
    <div class="d-flex gap-2">
      <select class="form-select" style="width: 200px;" id="categoryFilter" onchange="filterItems()">
        <option value="all">All Categories</option>
        <option value="jersey">Jerseys</option>
        <option value="training">Training</option>
        <option value="accessory">Accessories</option>
      </select>
      <input type="text" class="form-control" id="searchInput" onkeyup="filterItems()" placeholder="Search title or description..." style="width: 250px;">
    </div>

    <div class="bg-light p-3 rounded shadow-sm" style="cursor: pointer;" onclick="openCartModal()">
      <strong>🛒 View Cart:</strong> <span id="cartTotal">£0.00</span>
    </div>  
  </div>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="productGrid">

    <div class="col store-item jersey">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/home_kit.webp') }}" class="card-img-top" alt="Home Kit">
        <div class="card-body text-center">
          <h5 class="card-title">🏠 Home Jersey 2024/25</h5>
          <p class="fw-bold">£67.00</p>
          <button class="btn btn-primary" onclick="addToCart(67, 'Home Jersey 2024/25', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item jersey">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/away_kit.webp') }}" class="card-img-top" alt="Away Kit">
        <div class="card-body text-center">
          <h5 class="card-title">✈️ Away Jersey 2024/25</h5>
          <p class="fw-bold">£67.00</p>
          <button class="btn btn-primary" onclick="addToCart(67, 'Away Jersey 2024/25', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item jersey">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/third_kit.webp') }}" class="card-img-top" alt="Third Kit">
        <div class="card-body text-center">
          <h5 class="card-title">💎 Third Kit 2024/25</h5>
          <p class="fw-bold">£67.00</p>
          <button class="btn btn-primary" onclick="addToCart(67, 'Third Kit 2024/25', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item jersey">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/gk_kit.webp') }}" class="card-img-top" alt="Goalkeeper Kit">
        <div class="card-body text-center">
          <h5 class="card-title">🧤 Goalkeeper Kit</h5>
          <p class="fw-bold">£67.00</p>
          <button class="btn btn-primary" onclick="addToCart(67, 'Goalkeeper Kit', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item training">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/training_shorts.webp') }}" class="card-img-top" alt="Training Shorts">
        <div class="card-body text-center">
          <h5 class="card-title">🏃 Training Shorts</h5>
          <p class="fw-bold">£29.00</p>
          <button class="btn btn-primary" onclick="addToCart(29, 'Training Shorts', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item training">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/training_jackets.webp') }}" class="card-img-top" alt="Warm-up Jacket">
        <div class="card-body text-center">
          <h5 class="card-title">🏋️‍♂️ Warm-up Jacket</h5>
          <p class="fw-bold">£47.00</p>
          <button class="btn btn-primary" onclick="addToCart(47, 'Warm-up Jacket', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item training">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/hoodie.webp') }}" class="card-img-top" alt="Club Hoodie">
        <div class="card-body text-center">
          <h5 class="card-title">👕 Club Hoodie</h5>
          <p class="fw-bold">£55.00</p>
          <button class="btn btn-primary" onclick="addToCart(55, 'Club Hoodie', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/scarf.webp') }}" class="card-img-top" alt="Scarf">
        <div class="card-body text-center">
          <h5 class="card-title">🧣 Fan Scarf</h5>
          <p class="fw-bold">£15.00</p>
          <button class="btn btn-primary" onclick="addToCart(15, 'Fan Scarf', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/cap.webp') }}" class="card-img-top" alt="Fan Cap">
        <div class="card-body text-center">
          <h5 class="card-title">🧢 Fan Cap</h5>
          <p class="fw-bold">£19.00</p>
          <button class="btn btn-primary" onclick="addToCart(19, 'Fan Cap', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/phone_case.webp') }}" class="card-img-top" alt="Phone Case">
        <div class="card-body text-center">
          <h5 class="card-title">📱 Phone Case</h5>
          <p class="fw-bold">£12.00</p>
          <button class="btn btn-primary" onclick="addToCart(12, 'Phone Case', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/water_bottle.webp') }}" class="card-img-top" alt="Water Bottle">
        <div class="card-body text-center">
          <h5 class="card-title">💧 Water Bottle</h5>
          <p class="fw-bold">£10.00</p>
          <button class="btn btn-primary" onclick="addToCart(10, 'Water Bottle', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/bag.webp') }}" class="card-img-top" alt="Gym Bag">
        <div class="card-body text-center">
          <h5 class="card-title">🎒 Gym Bag</h5>
          <p class="fw-bold">£39.00</p>
          <button class="btn btn-primary" onclick="addToCart(39, 'Gym Bag', this)">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="col store-item accessory">
      <div class="card h-100 shadow-sm product-card">
        <img src="{{ url_for('static', filename='images/mug.webp') }}" class="card-img-top" alt="Mug">
        <div class="card-body text-center">
          <h5 class="card-title">☕ Coffee Mug</h5>
          <p class="fw-bold">£9.00</p>
          <button class="btn btn-primary" onclick="addToCart(9, 'Coffee Mug', this)">Add to Cart</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Cart Modal -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">🛒 Your Cart</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul id="cartItems" class="list-group mb-3"></ul>
        <h5 class="text-end">Total: <span id="modalCartTotal">£0.00</span></h5>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script>
  let cart = [];

  function addToCart(price, name, btnElement) {
  cart.push({ name, price });
  updateCartDisplay();

  if (btnElement) {
    const originalText = btnElement.innerText;
    btnElement.classList.add("btn-added");
    btnElement.innerText = "✅ Added!";
    btnElement.disabled = true;

    setTimeout(() => {
      btnElement.innerText = originalText;
      btnElement.classList.remove("btn-added");
      btnElement.disabled = false;
    }, 1500);
  }
}

  function updateCartDisplay() {
    let total = 0;
    const cartList = document.getElementById("cartItems");
    cartList.innerHTML = "";

    if (cart.length === 0) {
      cartList.innerHTML = `<li class="list-group-item">Your cart is empty.</li>`;
    } else {
      cart.forEach(item => {
        total += item.price;
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `${item.name} <span>£${item.price.toFixed(2)}</span>`;
        cartList.appendChild(li);
      });
    }

    document.getElementById("cartTotal").innerText = `£${total.toFixed(2)}`;
    document.getElementById("modalCartTotal").innerText = `£${total.toFixed(2)}`;
  }

  function openCartModal() {
    updateCartDisplay();
    const modal = new bootstrap.Modal(document.getElementById('cartModal'));
    modal.show();
  }

  function filterItems() {
  const category = document.getElementById('categoryFilter').value.toLowerCase();
  const search = document.getElementById('searchInput').value.toLowerCase();

  document.querySelectorAll('.store-item').forEach(item => {
    const title = item.querySelector('.card-title')?.innerText.toLowerCase() || '';
    const desc = item.querySelector('.card-text')?.innerText.toLowerCase() || ''; // fallback safe
    const matchesSearch = title.includes(search) || desc.includes(search);
    const matchesCategory = category === "all" || item.classList.contains(category);

    item.style.display = (matchesSearch && matchesCategory) ? 'block' : 'none';
    });
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>